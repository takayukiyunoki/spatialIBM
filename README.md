# spatialIBM
R sources used by Yunoki, T. (2021) In a niche-neutral continuum, a set of theoretical models in a metacommunity operates simultaneously in patchy habitats

In this study, the interaction between ecological and evolutionary mechanisms was addressed by a spatially explicit synthesis between niche-based processes and neutral dynamics to explain the origin and maintenance of biodiversity. An individual-based model was implemented in a two-dimensional grid with periodic boundary conditions. By controlling the approximate scale of the system, the model communities (i.e., a metacommunity) in the center of the system had a fixed population size, and were selected from an area encompassing independent biogeographic units to an area packed in a biogeographic unit with open boundary conditions, and presented three environmental structures: four humps, linear, and random. The initial species pool in the system was varied by a large range of species-neutral and functional diversities. Across scenarios, the number of guilds in the system first reached a stationary state; then, the species richness eventually converged to a dynamical equilibrium through the speciation–extinction balance. In simulations, the environmental niche only affected the per capita probabilities of immigration success; then, the functional uniqueness in model communities increased and the relative portion explained by environmental component was maximum at the highest dispersal rate in an area packed within a biogeographic unit. The neutral dynamics among the species of a single guild; the patchy dynamics among the species of similar environmental optimum and different specialization levels; and the mass effect, such as weak species¬–environment association, operated in the spatial structures found within and among patchy habitats. Hence, in a niche-neutral continuum, a set of theoretical models in a metacommunity operates simultaneously in patchy habitats; the dispersal modes of biota may affect how the influence of environmental filtering changes across ecological–evolutionary scales. The general patterns observed in simulations allowed a theoretical synthesis on a metacommunity and helped to explain complex patterns observed in the real world.
