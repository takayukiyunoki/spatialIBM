# spatialIBM
R sources used by Yunoki, T. (2020) Niche-based process and neutral dynamics emerge the per capita ecological difference and equivalence among species at different spatio-temporal-environmental scales. DOI: 10.22541/au.160622173.36008852/v1

Reconciling niche-based process and neutral dynamics in a portion of an infinite system, the species richness and relative species abundance in a metacommunity may be already not free parameter, and the divergent ecological-evolutionary mechanisms may operate consistently. The individual-based model was implemented in the two-dimensional grid with periodic boundary condition. The model was explored using a fixed speciation rate and local community size, and a range of site numbers, dispersal rates, environmental structures and initial species pools in system. The model communities (i.e. metacommunity) in the center of system had a fixed population size, and approximated from an area encompassing independent biogeographic units to an area packed in a biogeographic unit with open boundary conditions, and presented the three environmental structures; four humps, linear and random. Across scenarios, the number of guilds in system achieved first to a stationary state; then, the species richness converged eventually to a dynamical equilibrium through speciation-extinction balance. In simulations, the environmental niche only affected to the per capita probabilities of immigration success, so the weighted lottery process was more efficient at higher dispersal rates. The increase of functional redundancy in model communities suggested that the relative role of neutral dynamics increased in an area encompassing independent biogeographic units through speciation. The variation partitioning based on canonical analysis inferred that not only the neutral dynamics among the species of single guild, but also the competition-colonization trade-off among the species of similar environmental optimum and different levels of specialization operated in the spatial structures found within and among patchy habitats. Ecologist to disentangle the influence of alternative processes must shift focus from the contribution of local competitions and regional dispersals to detecting the spatio-temporal-environmental scales on which the per capita ecological difference and equivalence among species are emerged through divergent ecological-evolutionary mechanisms.  

The data analyses were performed on R version 3.6.3 (R Core Team, 2019) using the packages spdep (Bivand et al., 2019), vegan (Oksanen et al., 2019), PCNM (Legendre, Borcard, Blanchet, & Dray 2012), randomizr (Coppock, Cooper, & Fultz 2019), reshape2 (Wickham, 2017), dplyr (Wickham, François, Henry, Müller, & RStudio 2019), entropart (Marcon & Hérault, 2019), packfor (Dray, Legendre, & Blanchet 2016), pgirmess (Giraudoux, Antonietti, Beale, Pleydell, & Treglia 2018), and ape (Paradis et al., 2019). 
